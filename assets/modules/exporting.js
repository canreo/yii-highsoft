/*
 @product.name@ JS v@product.version@ (@product.date@)
 Exporting module

 (c) 2010-2011 Torstein HÃ¸nsi

 License: www.highcharts.com/license
*/
(function(e){function z(a){for(var b=a.length;b--;)"number"===typeof a[b]&&(a[b]=Math.round(a[b])-0.5);return a}var A=e.Chart,v=e.addEvent,C=e.removeEvent,j=e.createElement,w=e.discardElement,u=e.css,l=e.merge,k=e.each,p=e.extend,D=Math.max,i=document,E=window,F=e.isTouchDevice,B=e.Renderer.prototype.symbols,x=e.getOptions();p(x.lang,{downloadPNG:"Download PNG image",downloadJPEG:"Download JPEG image",downloadPDF:"Download PDF document",downloadSVG:"Download SVG vector image",exportButtonTitle:"Export to raster or vector image",
printButtonTitle:"Print the chart"});x.navigation={menuStyle:{border:"1px solid #A0A0A0",background:"#FFFFFF"},menuItemStyle:{padding:"0 5px",background:"none",color:"#303030",fontSize:F?"14px":"11px"},menuItemHoverStyle:{background:"#4572A5",color:"#FFFFFF"},buttonOptions:{align:"right",backgroundColor:{linearGradient:[0,0,0,20],stops:[[0.4,"#F7F7F7"],[0.6,"#E3E3E3"]]},borderColor:"#B0B0B0",borderRadius:3,borderWidth:1,height:20,hoverBorderColor:"#909090",hoverSymbolFill:"#81A7CF",hoverSymbolStroke:"#4572A5",
symbolFill:"#E0E0E0",symbolStroke:"#A0A0A0",symbolX:11.5,symbolY:10.5,verticalAlign:"top",width:24,y:10}};x.exporting={type:"image/png",url:"http://export.highcharts.com/",width:800,buttons:{exportButton:{symbol:"exportIcon",x:-10,symbolFill:"#A8BF77",hoverSymbolFill:"#768F3E",_id:"exportButton",_titleKey:"exportButtonTitle",menuItems:[{textKey:"downloadPNG",onclick:function(){this.exportChart()}},{textKey:"downloadJPEG",onclick:function(){this.exportChart({type:"image/jpeg"})}},{textKey:"downloadPDF",
onclick:function(){this.exportChart({type:"application/pdf"})}},{textKey:"downloadSVG",onclick:function(){this.exportChart({type:"image/svg+xml"})}}]},printButton:{symbol:"printIcon",x:-36,symbolFill:"#B5C9DF",hoverSymbolFill:"#779ABF",_id:"printButton",_titleKey:"printButtonTitle",onclick:function(){this.print()}}}};e.post=function(a,b){var c,d;d=j("form",{method:"post",action:a,enctype:"multipart/form-data"},{display:"none"},i.body);for(c in b)j("input",{type:"hidden",name:c,value:b[c]},null,d);
d.submit();w(d)};p(A.prototype,{getSVG:function(a){var b=this,c,d,f,g=l(b.options,a);i.createElementNS||(i.createElementNS=function(a,b){return i.createElement(b)});a=j("div",null,{position:"absolute",top:"-9999em",width:b.chartWidth+"px",height:b.chartHeight+"px"},i.body);p(g.chart,{renderTo:a,forExport:!0});g.exporting.enabled=!1;g.chart.plotBackgroundImage=null;g.series=[];k(b.series,function(a){f=l(a.options,{animation:!1,showCheckbox:!1,visible:a.visible});f.isInternal||g.series.push(f)});c=
new e.Chart(g);k(["xAxis","yAxis"],function(a){k(b[a],function(b,d){var f=c[a][d],g=b.getExtremes(),e=g.userMin,g=g.userMax;(void 0!==e||void 0!==g)&&f.setExtremes(e,g,!0,!1)})});d=c.container.innerHTML;g=null;c.destroy();w(a);d=d.replace(/zIndex="[^"]+"/g,"").replace(/isShadow="[^"]+"/g,"").replace(/symbolName="[^"]+"/g,"").replace(/jQuery[0-9]+="[^"]+"/g,"").replace(/isTracker="[^"]+"/g,"").replace(/url\([^#]+#/g,"url(#").replace(/<svg /,'<svg xmlns:xlink="http://www.w3.org/1999/xlink" ').replace(/ href=/g,
" xlink:href=").replace(/\n/," ").replace(/<\/svg>.*?$/,"</svg>").replace(/&nbsp;/g,"\u00a0").replace(/&shy;/g,"\u00ad").replace(/<IMG /g,"<image ").replace(/height=([^" ]+)/g,'height="$1"').replace(/width=([^" ]+)/g,'width="$1"').replace(/hc-svg-href="([^"]+)">/g,'xlink:href="$1"/>').replace(/id=([^" >]+)/g,'id="$1"').replace(/class=([^" ]+)/g,'class="$1"').replace(/ transform /g," ").replace(/:(path|rect)/g,"$1").replace(/style="([^"]+)"/g,function(a){return a.toLowerCase()});d=d.replace(/(url\(#highcharts-[0-9]+)&quot;/g,
"$1").replace(/&quot;/g,"'");2===d.match(/ xmlns="/g).length&&(d=d.replace(/xmlns="[^"]+"/,""));return d},exportChart:function(a,b){var c=this.options.exporting,d=this.getSVG(l(c.chartOptions,b)),a=l(c,a);e.post(a.url,{filename:a.filename||"chart",type:a.type,width:a.width,scale:a.scale||2,svg:d})},print:function(){var a=this,b=a.container,c=[],d=b.parentNode,f=i.body,g=f.childNodes;a.isPrinting||(a.isPrinting=!0,k(g,function(a,b){1===a.nodeType&&(c[b]=a.style.display,a.style.display="none")}),f.appendChild(b),
E.print(),setTimeout(function(){d.appendChild(b);k(g,function(a,b){1===a.nodeType&&(a.style.display=c[b])});a.isPrinting=!1},1E3))},contextMenu:function(a,b,c,d,f,g){var e=this,q=e.options.navigation,i=q.menuItemStyle,r=e.chartWidth,s=e.chartHeight,t="cache-"+a,h=e[t],m=D(f,g),y,n,l;h||(e[t]=h=j("div",{className:"highcharts-"+a},{position:"absolute",zIndex:1E3,padding:m+"px"},e.container),y=j("div",null,p({MozBoxShadow:"3px 3px 10px #888",WebkitBoxShadow:"3px 3px 10px #888",boxShadow:"3px 3px 10px #888"},
q.menuStyle),h),n=function(){u(h,{display:"none"})},v(h,"mouseleave",function(){l=setTimeout(n,500)}),v(h,"mouseenter",function(){clearTimeout(l)}),k(b,function(a){if(a){var b=j("div",{onmouseover:function(){u(this,q.menuItemHoverStyle)},onmouseout:function(){u(this,i)},innerHTML:a.text||e.options.lang[a.textKey]},p({cursor:"pointer"},i),y);b.onclick=function(){n();a.onclick.apply(e,arguments)};e.exportDivElements.push(b)}}),e.exportDivElements.push(y,h),e.exportMenuWidth=h.offsetWidth,e.exportMenuHeight=
h.offsetHeight);a={display:"block"};c+e.exportMenuWidth>r?a.right=r-c-f-m+"px":a.left=c-m+"px";d+g+e.exportMenuHeight>s?a.bottom=s-d-m+"px":a.top=d+g-m+"px";u(h,a)},addButton:function(a){function b(){s.attr(k);r.attr(m)}var c=this,d=c.renderer,f=l(c.options.navigation.buttonOptions,a),e=f.onclick,i=f.menuItems,q=f.width,j=f.height,r,s,t,h,a=f.borderWidth,m={stroke:f.borderColor},k={stroke:f.symbolStroke,fill:f.symbolFill},n=f.symbolSize||12;c.btnCount||(c.btnCount=0);h=c.btnCount++;c.exportDivElements||
(c.exportDivElements=[],c.exportSVGElements=[]);!1!==f.enabled&&(r=d.rect(0,0,q,j,f.borderRadius,a).align(f,!0).attr(p({fill:f.backgroundColor,"stroke-width":a,zIndex:19},m)).add(),t=d.rect(0,0,q,j,0).align(f).attr({id:f._id,fill:"rgba(255, 255, 255, 0.001)",title:c.options.lang[f._titleKey],zIndex:21}).css({cursor:"pointer"}).on("mouseover",function(){s.attr({stroke:f.hoverSymbolStroke,fill:f.hoverSymbolFill});r.attr({stroke:f.hoverBorderColor})}).on("mouseout",b).on("click",b).add(),i&&(e=function(){b();
var a=t.getBBox();c.contextMenu("menu"+h,i,a.x,a.y,q,j)}),t.on("click",function(){e.apply(c,arguments)}),s=d.symbol(f.symbol,f.symbolX-n/2,f.symbolY-n/2,n,n).align(f,!0).attr(p(k,{"stroke-width":f.symbolStrokeWidth||1,zIndex:20})).add(),c.exportSVGElements.push(r,t,s))},destroyExport:function(){var a,b;for(a=0;a<this.exportSVGElements.length;a++)b=this.exportSVGElements[a],b.onclick=b.ontouchstart=null,this.exportSVGElements[a]=b.destroy();for(a=0;a<this.exportDivElements.length;a++)b=this.exportDivElements[a],
C(b,"mouseleave"),this.exportDivElements[a]=b.onmouseout=b.onmouseover=b.ontouchstart=b.onclick=null,w(b)}});B.exportIcon=function(a,b,c,d){return z(["M",a,b+c,"L",a+c,b+d,a+c,b+0.8*d,a,b+0.8*d,"Z","M",a+0.5*c,b+0.8*d,"L",a+0.8*c,b+0.4*d,a+0.4*c,b+0.4*d,a+0.4*c,b,a+0.6*c,b,a+0.6*c,b+0.4*d,a+0.2*c,b+0.4*d,"Z"])};B.printIcon=function(a,b,c,d){return z(["M",a,b+0.7*d,"L",a+c,b+0.7*d,a+c,b+0.4*d,a,b+0.4*d,"Z","M",a+0.2*c,b+0.4*d,"L",a+0.2*c,b,a+0.8*c,b,a+0.8*c,b+0.4*d,"Z","M",a+0.2*c,b+0.7*d,"L",a,b+
d,a+c,b+d,a+0.8*c,b+0.7*d,"Z"])};A.prototype.callbacks.push(function(a){var b,c=a.options.exporting,d=c.buttons;if(!1!==c.enabled){for(b in d)a.addButton(d[b]);v(a,"destroy",a.destroyExport)}})})(Highcharts);window.console&&console.log("--- Running modules/exporting.src.js from GitHub, branch master ---");
